# ワイチャ！

オンラインセミナーでワイワイチャットできるリアルタイム反応システムです。

## 機能

### 基本機能
- 匿名でのリアルタイム反応・質問投稿
- 質問・コメントのチャット形式表示
- 文字による反応送信（背景フローティング表示）
- 自動スクロール機能（最下部にいる時のみ）
- セミナールーム管理

### 新機能
- **回答システム**: 投稿をクリックして回答を追加
- **会話ログエクスポート**: JSON形式でダウンロード可能
- **改善されたUI**: 読みやすい文字色、チャット中心のレイアウト
- **即座のルーム作成**: 作成後すぐにルームに移動

## 技術スタック

- **フロントエンド**: Next.js 14+, React, TypeScript
- **リアルタイム通信**: Socket.IO
- **スタイリング**: TailwindCSS
- **開発環境**: Node.js, npm

## セットアップ

1. 依存関係のインストール
```bash
npm install
```

2. 開発サーバーの起動
```bash
# Socket.IOサーバーとNext.jsを同時に起動
npm run dev-all

# または個別に起動
npm run server  # Socket.IOサーバー (ポート3001)
npm run dev     # Next.jsサーバー (ポート3000)
```

## ローカルネットワークでの利用

同一ネットワーク内の他のデバイスからアクセスする場合：

1. PCのIPアドレスを確認
```bash
# Windows
ipconfig

# Linux/Mac
ip addr show
# または
ifconfig
```

2. 他のデバイスから以下のURLでアクセス
```
http://[PCのIPアドレス]:3000
```

例: `http://192.168.1.100:3000`

## 使用方法

### 基本的な使い方
1. ホームページでセミナールームを作成または既存のルームに参加
2. 質問・コメントはテキスト入力で送信（メイン画面に表示）
3. 反応ボタン（へぇ、いいね、？？？、ぱちぱち）をクリックして反応を送信
4. 反応は画面背景にフローティングアニメーションで表示

### 回答システム
1. 投稿をクリックして回答モーダルを開く
2. 回答を入力して投稿
3. 回答がある投稿には青いバッジが表示される
4. 既存の回答も確認可能

### 会話ログエクスポート
1. セミナールーム画面で「会話をエクスポート」ボタンをクリック
2. JSON形式のファイルが自動ダウンロード
3. ファイルには投稿内容、回答、タイムスタンプが含まれる

## UI改善点

- **文字の可読性向上**: 薄い灰色から濃い色に変更
- **チャット中心レイアウト**: 質問・コメントをメイン画面に表示
- **自動スクロール**: 新しいメッセージが投稿されると自動スクロール（最下部にいる場合のみ）
- **反応の視覚化**: 絵文字の代わりに文字で反応、背景に目立つ表示

## 注意事項

- Socket.IOサーバーとNext.jsサーバーの両方を起動する必要があります
- 同一ネットワーク内でのみ利用可能です
- セミナールームのデータはメモリ上に保存されるため、サーバー再起動時に消去されます
- 会話ログは手動でエクスポートする必要があります（自動保存機能なし）

## ファイル構造

```
src/
├── app/
│   ├── page.tsx              # ホームページ（ルーム作成・参加）
│   ├── room/[roomId]/
│   │   └── page.tsx          # セミナールームインターフェース
│   └── globals.css           # TailwindCSS imports
├── server.ts                 # Socket.IOサーバー（回答・エクスポート機能含む）
└── ...
```

## 開発者向け情報

### 新機能の実装詳細
- 回答システム: メッセージ構造に`replies`配列を追加
- エクスポート機能: サーバーサイドでJSON形式の会話ログ生成
- 自動スクロール: `useRef`と`useEffect`でスクロール位置を監視
- UI改善: TailwindCSSのカラーパレット調整

### Socket.IOイベント
- `send-reaction`: 反応・質問の送信
- `send-reply`: 回答の送信
- `export-chat`: 会話ログのエクスポート
- `message-updated`: 回答追加時のメッセージ更新通知